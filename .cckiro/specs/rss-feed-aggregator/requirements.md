# RSSフィードアグリゲーター機能 要件定義書

## 1. 概要

個人やチームが散らばっているRSSフィードをまとめて管理・表示するアグリゲーター機能を実装する。ユーザーは自分のRSSフィードを登録し、他のユーザーやチームを購読することで、関心のある記事を一元的に閲覧できる。

## 2. 機能要件

### 2.1 RSSフィード管理機能

#### 2.1.1 フィード登録

- ユーザーは自分のRSSフィードURLを登録できる
- 登録可能数の制限：
  - 無料ユーザー：最大5つ
  - 有料ユーザー（サブスクリプション保有者）：最大50つ
- フィードの有効性チェック機能

#### 2.1.2 フィード管理

- 登録済みフィードの一覧表示
- フィードの編集（URL、タイトル等）
- フィードの削除
- フィードの有効/無効切り替え

### 2.2 記事収集・管理機能

#### 2.2.1 記事の自動収集

- GitHub Actionsを使用して1時間ごとに実行
- 各フィードから新着記事を取得
- 記事の重複チェック（同一URLの記事は保存しない）

#### 2.2.2 記事の保存

- 記事情報の永続保存（保存期間の制限なし）
- 保存する情報：
  - タイトル
  - URL
  - 概要/本文の抜粋
  - 公開日時
  - 著者情報（あれば）
  - OpenGraph画像URL（あれば）
  - 元のフィードID

### 2.3 購読機能

#### 2.3.1 購読対象

- 他のユーザーを購読できる
- チームを購読できる
- 購読数に制限なし

#### 2.3.2 購読管理

- 購読中のユーザー/チーム一覧
- 購読の追加/解除
- 購読したユーザー/チームの記事を時系列で表示

### 2.4 表示機能

#### 2.4.1 ユーザープロフィールページ

- そのユーザーが登録したRSSフィードの記事を時系列（新しい順）で表示
- ページネーション対応

#### 2.4.2 トップページ（ログイン後）

- ログインユーザーが購読しているユーザー/チームの記事を時系列で表示
- チームとユーザーで同じ記事を購読している場合の重複排除
- ページネーション対応

#### 2.4.3 チームページ

- チームメンバーの記事を集約して時系列で表示
- チームメンバーが登録したすべてのフィードの記事が対象

## 3. 非機能要件

### 3.1 パフォーマンス

- 記事の表示は高速に行う（適切なインデックス設計）
- フィード更新処理の並行実行による効率化

### 3.2 スケーラビリティ

- 大量のフィード・記事に対応できる設計
- GitHub Actionsの実行時間制限を考慮した設計

### 3.3 信頼性

- フィード取得エラーのハンドリング
- 部分的な失敗でも他のフィードの更新は継続

### 3.4 セキュリティ

- RSSフィードURLの検証
- XSS対策（記事コンテンツのサニタイズ）

## 4. 制約事項

### 4.1 既存システムとの統合

- 既存のユーザー管理システムを使用
- 既存のStripe決済機能と連携（有料/無料の判定）
- 既存のチーム機能を活用

### 4.2 技術的制約

- React Router v7 + Cloudflare Workers環境
- Cloudflare D1データベース + Drizzle ORM
- GitHub Actionsでの定期実行（TypeScriptスクリプト）

## 5. 前提条件

- ユーザーは既にシステムに登録済み
- 有料ユーザーの判定は既存のサブスクリプション管理機能を使用
- チーム機能は既に実装済みのものを使用
